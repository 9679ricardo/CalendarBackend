£
QE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IBD_Usuario.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 
IBD_Usuario  
{ 
Task 
< 
bool 
> 
BD_Buscar_Correo #
(# $
string$ *
email+ 0
)0 1
;1 2
Task		 
<		 
int		 
>		  
BD_Registrar_Usuario		 &
(		& '
UsuarioRegister		' 6
usuario		7 >
)		> ?
;		? @
Task

 
<

 
	DataTable

 
>

 
DB_Login

  
(

  !
string

! '
email

( -
)

- .
;

. /
} 
} ¶
PE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IDB_Evento.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 

IDB_Evento 
{ 
Task 
< 
bool 
> 
BD_Editar_Evento #
(# $
Evento$ *
evento+ 1
)1 2
;2 3
Task		 
<		 
bool		 
>		 
BD_Eliminar_Evento		 %
(		% &
int		& )
Id_Even		* 1
,		1 2
int		3 6
uid		7 :
)		: ;
;		; <
Task

 
<

 
bool

 
>

 '
BD_Eliminar_Evento_Relacion

 .
(

. /
int

/ 2
Id_Even

3 :
,

: ;
int

< ?
uid

@ C
)

C D
;

D E
Task 
< 
bool 
> &
BD_Eliminar_Evento_Usuario -
(- .
int. 1
Id_Not2 8
)8 9
;9 :
Task 
< 
	DataTable 
> *
DB_Mostar_Todos_Evento_Usuario 6
(6 7
int7 :
uid; >
)> ?
;? @
Task 
< 
	DataTable 
> +
DB_Mostar_Todos_Usuarios_Evento 7
(7 8
int8 ;
Id_Even< C
)C D
;D E
Task 
< 
int 
> 
BD_Registrar_Evento %
(% &
Evento& ,
evento- 3
)3 4
;4 5
Task 
< 
int 
> (
BD_Registrar_Evento_Relacion .
(. /
int/ 2
Id_Even3 :
,: ;
int< ?
uid@ C
)C D
;D E
Task 
< 
	DataTable 
> 
BD_Buscar_Evento (
(( )
int) ,
Id_Not- 3
)3 4
;4 5
} 
} ê
VE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IDB_Notificacion.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 
IDB_Notificacion %
{ 
Task 
< 
int 
> %
BD_Registrar_Notificacion +
(+ , 
NotificacionRegister, @
notificacionA M
)M N
;N O
Task		 
<		 
bool		 
>		 $
BD_Eliminar_Notificacion		 +
(		+ ,
int		, /
Id_Not		0 6
,		6 7
int		8 ;
Id_Usu		< B
)		B C
;		C D
Task

 
<

 
	DataTable

 
>

 0
$DB_Mostar_Todas_Notificacion_Usuario

 <
(

< =
int

= @
Id_Usu

A G
)

G H
;

H I
} 
} ÷F
OE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SBD_Usuario.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 
SBD_Usuario 
: 
IBD_Usuario *
{ 
private		 
readonly		 
string		 
con		  #
=		$ %
$str		& t
;		t u
public 
async 
Task 
< 
bool 
> 
BD_Buscar_Correo  0
(0 1
string1 7
email8 =
)= >
{ 	
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
bool 
	respuesta 
= 
false "
;" #
try 
{ 

SqlCommand 
cmd 
=  
new! $
($ %
)% &
;& '
cn 
. 
ConnectionString #
=$ %
con& )
;) *
cmd 
. 
CommandText 
=  !
$str" 5
;5 6
cmd 
. 

Connection 
=  
cn! #
;# $
cmd 
. 
CommandTimeout "
=# $
$num% '
;' (
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
email6 ;
); <
;< =
await 
cn 
. 
	OpenAsync "
(" #
)# $
;$ %
int 
getValue 
= 
Convert &
.& '
ToInt32' .
(. /
cmd/ 2
.2 3
ExecuteScalar3 @
(@ A
)A B
)B C
;C D
if!! 
(!! 
getValue!! 
>!! 
$num!!  
)!!  !
{"" 
	respuesta## 
=## 
true##  $
;##$ %
}$$ 
else%% 
{&& 
	respuesta'' 
='' 
false''  %
;''% &
}(( 
cmd** 
.** 

Parameters** 
.** 
Clear** $
(**$ %
)**% &
;**& '
cmd++ 
.++ 
Dispose++ 
(++ 
)++ 
;++ 
cn,, 
.,, 
Close,, 
(,, 
),, 
;,, 
return.. 
	respuesta..  
;..  !
}// 
catch00 
(00 
	Exception00 
)00 
{11 
if33 
(33 
cn33 
.33 
State33 
==33 
ConnectionState33  /
.33/ 0
Open330 4
)334 5
{44 
cn55 
.55 
Close55 
(55 
)55 
;55 
}66 
return88 
	respuesta88  
;88  !
}99 
}:: 	
public<< 
async<< 
Task<< 
<<< 
int<< 
><<  
BD_Registrar_Usuario<< 3
(<<3 4
UsuarioRegister<<4 C
usuario<<D K
)<<K L
{== 	
SqlConnection>> 
cn>> 
=>> 
new>> "
(>>" #
)>># $
;>>$ %
int@@ 
	respuesta@@ 
;@@ 
tryBB 
{CC 

SqlCommandDD 
cmdDD 
=DD  
newDD! $
(DD$ %
)DD% &
;DD& '
cnEE 
.EE 
ConnectionStringEE #
=EE$ %
conEE& )
;EE) *
cmdFF 
.FF 
CommandTextFF 
=FF  !
$strFF" 2
;FF2 3
cmdGG 
.GG 

ConnectionGG 
=GG  
cnGG! #
;GG# $
cmdHH 
.HH 
CommandTimeoutHH "
=HH# $
$numHH% '
;HH' (
cmdII 
.II 
CommandTypeII 
=II  !
CommandTypeII" -
.II- .
StoredProcedureII. =
;II= >
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 3
,KK3 4
usuarioKK5 <
.KK< =
NameKK= A
.KKA B
TrimKKB F
(KKF G
)KKG H
)KKH I
;KKI J
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 7
,LL7 8
usuarioLL9 @
.LL@ A
PasswordLLA I
.LLI J
TrimLLJ N
(LLN O
)LLO P
)LLP Q
;LLQ R
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 4
,MM4 5
usuarioMM6 =
.MM= >
EmailMM> C
.MMC D
TrimMMD H
(MMH I
)MMI J
)MMJ K
;MMK L
awaitOO 
cnOO 
.OO 
	OpenAsyncOO "
(OO" #
)OO# $
;OO$ %
intQQ 
getValueQQ 
=QQ 
ConvertQQ &
.QQ& '
ToInt32QQ' .
(QQ. /
awaitQQ/ 4
cmdQQ5 8
.QQ8 9
ExecuteScalarAsyncQQ9 K
(QQK L
)QQL M
)QQM N
;QQN O
ifSS 
(SS 
getValueSS 
>SS 
$numSS  
)SS  !
{TT 
	respuestaUU 
=UU 
getValueUU  (
;UU( )
}VV 
elseWW 
{XX 
	respuestaYY 
=YY 
$numYY  !
;YY! "
}ZZ 
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Clear\\ $
(\\$ %
)\\% &
;\\& '
cmd]] 
.]] 
Dispose]] 
(]] 
)]] 
;]] 
cn^^ 
.^^ 
Close^^ 
(^^ 
)^^ 
;^^ 
}__ 
catch`` 
(`` 
	Exception`` 
)`` 
{aa 
ifcc 
(cc 
cncc 
.cc 
Statecc 
==cc 
ConnectionStatecc  /
.cc/ 0
Opencc0 4
)cc4 5
{dd 
cnee 
.ee 
Closeee 
(ee 
)ee 
;ee 
}ff 
returnhh 
$numhh 
;hh 
}ii 
returnkk 
	respuestakk 
;kk 
}ll 	
publicnn 
asyncnn 
Tasknn 
<nn 
	DataTablenn #
>nn# $
DB_Loginnn% -
(nn- .
stringnn. 4
emailnn5 :
)nn: ;
{oo 	
SqlConnectionpp 
cnpp 
=pp 
newpp "
(pp" #
)pp# $
;pp$ %
	DataTableqq 
dataqq 
=qq 
newqq  
(qq  !
)qq! "
;qq" #
tryss 
{tt 
cnuu 
.uu 
ConnectionStringuu #
=uu$ %
conuu& )
;uu) *
SqlDataAdaptervv 
davv !
=vv" #
newvv$ '
(vv' (
$strvv( :
,vv: ;
cnvv< >
)vv> ?
;vv? @
daww 
.ww 
SelectCommandww  
.ww  !
CommandTypeww! ,
=ww- .
CommandTypeww/ :
.ww: ;
StoredProcedureww; J
;wwJ K
daxx 
.xx 
SelectCommandxx  
.xx  !

Parametersxx! +
.xx+ ,
AddWithValuexx, 8
(xx8 9
$strxx9 A
,xxA B
emailxxC H
)xxH I
;xxI J
awaitzz 
cnzz 
.zz 
	OpenAsynczz "
(zz" #
)zz# $
;zz$ %
da|| 
.|| 
Fill|| 
(|| 
data|| 
)|| 
;|| 
cn}} 
.}} 
Close}} 
(}} 
)}} 
;}} 
return~~ 
data~~ 
;~~ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
)
ÅÅ 
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
cn
ÉÉ 
.
ÉÉ 
State
ÉÉ 
==
ÉÉ 
ConnectionState
ÉÉ  /
.
ÉÉ/ 0
Open
ÉÉ0 4
)
ÉÉ4 5
{
ÑÑ 
cn
ÖÖ 
.
ÖÖ 
Close
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
return
àà 
data
àà 
;
àà 
}
ââ 
}
ää 	
}
ãã 
}åå ˜ÿ
NE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SDB_Evento.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 

SDB_Evento 
: 

IDB_Evento (
{ 
private		 
readonly		 
string		 
con		  #
=		$ %
$str		& t
;		t u
public

 
async

 
Task

 
<

 
bool

 
>

 
BD_Editar_Evento

  0
(

0 1
Evento

1 7
evento

8 >
)

> ?
{ 	
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
bool 
	respuesta 
= 
false "
;" #
try 
{ 
cn 
. 
ConnectionString #
=$ %
con& )
;) *

SqlCommand 
cmd 
=  
new! $
($ %
$str% 5
,5 6
cn7 9
)9 :
{ 
CommandTimeout "
=# $
$num% '
,' (
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Id= ?
)? @
;@ A
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
UserUid= D
)D E
;E F
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 6
,6 7
evento8 >
.> ?
User? C
)C D
;D E
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Title= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Notes= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Start= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 2
,2 3
evento4 :
.: ;
End; >
)> ?
;? @
await   
cn   
.   
	OpenAsync   "
(  " #
)  # $
;  $ %
int"" 
getValue"" 
="" 
Convert"" &
.""& '
ToInt32""' .
("". /
await""/ 4
cmd""5 8
.""8 9 
ExecuteNonQueryAsync""9 M
(""M N
)""N O
)""O P
;""P Q
if$$ 
($$ 
getValue$$ 
>$$ 
$num$$  
)$$  !
{%% 
	respuesta&& 
=&& 
false&&  %
;&&% &
}'' 
else(( 
{)) 
	respuesta** 
=** 
true**  $
;**$ %
}++ 
cn-- 
.-- 
Close-- 
(-- 
)-- 
;-- 
return// 
	respuesta//  
;//  !
}00 
catch11 
(11 
	Exception11 
)11 
{22 
if33 
(33 
cn33 
.33 
State33 
==33 
ConnectionState33  /
.33/ 0
Open330 4
)334 5
{44 
cn55 
.55 
Close55 
(55 
)55 
;55 
}66 
return88 
	respuesta88  
;88  !
}99 
}:: 	
public<< 
async<< 
Task<< 
<<< 
bool<< 
><< 
BD_Eliminar_Evento<<  2
(<<2 3
int<<3 6
Id_Even<<7 >
,<<> ?
int<<@ C
uid<<D G
)<<G H
{== 	
SqlConnection>> 
cn>> 
=>> 
new>> "
(>>" #
)>># $
;>>$ %
bool?? 
	respuesta?? 
=?? 
true?? !
;??! "
tryAA 
{BB 
cnCC 
.CC 
ConnectionStringCC #
=CC$ %
conCC& )
;CC) *

SqlCommandEE 
cmdEE 
=EE  
newEE! $
(EE$ %
$strEE% 7
,EE7 8
cnEE9 ;
)EE; <
{FF 
CommandTimeoutGG "
=GG# $
$numGG% '
,GG' (
CommandTypeHH 
=HH  !
CommandTypeHH" -
.HH- .
StoredProcedureHH. =
}II 
;II 
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 4
,KK4 5
Id_EvenKK6 =
)KK= >
;KK> ?
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 4
,LL4 5
uidLL6 9
)LL9 :
;LL: ;
awaitNN 
cnNN 
.NN 
	OpenAsyncNN "
(NN" #
)NN# $
;NN$ %
intPP 
getValuePP 
=PP 
ConvertPP &
.PP& '
ToInt32PP' .
(PP. /
awaitPP/ 4
cmdPP5 8
.PP8 9 
ExecuteNonQueryAsyncPP9 M
(PPM N
)PPN O
)PPO P
;PPP Q
ifRR 
(RR 
getValueRR 
>RR 
$numRR  
)RR  !
{SS 
	respuestaTT 
=TT 
falseTT  %
;TT% &
}UU 
elseVV 
{WW 
	respuestaXX 
=XX 
trueXX  $
;XX$ %
}YY 
cmd[[ 
.[[ 

Parameters[[ 
.[[ 
Clear[[ $
([[$ %
)[[% &
;[[& '
cmd\\ 
.\\ 
Dispose\\ 
(\\ 
)\\ 
;\\ 
cn]] 
.]] 
Close]] 
(]] 
)]] 
;]] 
return__ 
	respuesta__  
;__  !
}`` 
catchaa 
(aa 
	Exceptionaa 
)aa 
{bb 
ifcc 
(cc 
cncc 
.cc 
Statecc 
==cc 
ConnectionStatecc  /
.cc/ 0
Opencc0 4
)cc4 5
{dd 
cnee 
.ee 
Closeee 
(ee 
)ee 
;ee 
}ff 
returnhh 
	respuestahh  
;hh  !
}ii 
}jj 	
publicll 
asyncll 
Taskll 
<ll 
boolll 
>ll &
BD_Eliminar_Evento_Usuarioll  :
(ll: ;
intll; >
Id_Notll? E
)llE F
{mm 	
SqlConnectionnn 
cnnn 
=nn 
newnn "
(nn" #
)nn# $
;nn$ %
booloo 
	respuestaoo 
=oo 
trueoo !
;oo! "
tryqq 
{rr 
cnss 
.ss 
ConnectionStringss #
=ss$ %
conss& )
;ss) *

SqlCommanduu 
cmduu 
=uu  
newuu! $
(uu$ %
$struu% ?
,uu? @
cnuuA C
)uuC D
{vv 
CommandTimeoutww "
=ww# $
$numww% '
,ww' (
CommandTypexx 
=xx  !
CommandTypexx" -
.xx- .
StoredProcedurexx. =
}yy 
;yy 
cmd{{ 
.{{ 

Parameters{{ 
.{{ 
AddWithValue{{ +
({{+ ,
$str{{, 5
,{{5 6
Id_Not{{7 =
){{= >
;{{> ?
await}} 
cn}} 
.}} 
	OpenAsync}} "
(}}" #
)}}# $
;}}$ %
int 
getValue 
= 
Convert &
.& '
ToInt32' .
(. /
await/ 4
cmd5 8
.8 9 
ExecuteNonQueryAsync9 M
(M N
)N O
)O P
;P Q
if
ÅÅ 
(
ÅÅ 
getValue
ÅÅ 
>
ÅÅ 
$num
ÅÅ  
)
ÅÅ  !
{
ÇÇ 
	respuesta
ÉÉ 
=
ÉÉ 
false
ÉÉ  %
;
ÉÉ% &
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
	respuesta
áá 
=
áá 
true
áá  $
;
áá$ %
}
àà 
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
Clear
ää $
(
ää$ %
)
ää% &
;
ää& '
cmd
ãã 
.
ãã 
Dispose
ãã 
(
ãã 
)
ãã 
;
ãã 
cn
åå 
.
åå 
Close
åå 
(
åå 
)
åå 
;
åå 
return
éé 
	respuesta
éé  
;
éé  !
}
èè 
catch
êê 
(
êê 
	Exception
êê 
)
êê 
{
ëë 
if
íí 
(
íí 
cn
íí 
.
íí 
State
íí 
==
íí 
ConnectionState
íí  /
.
íí/ 0
Open
íí0 4
)
íí4 5
{
ìì 
cn
îî 
.
îî 
Close
îî 
(
îî 
)
îî 
;
îî 
}
ïï 
return
óó 
	respuesta
óó  
;
óó  !
}
òò 
}
ôô 	
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
	DataTable
õõ #
>
õõ# $,
DB_Mostar_Todos_Evento_Usuario
õõ% C
(
õõC D
int
õõD G
uid
õõH K
)
õõK L
{
úú 	
SqlConnection
ùù 
cn
ùù 
=
ùù 
new
ùù "
(
ùù" #
)
ùù# $
;
ùù$ %
	DataTable
ûû 
data
ûû 
=
ûû 
new
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
try
†† 
{
°° 
cn
¢¢ 
.
¢¢ 
ConnectionString
¢¢ #
=
¢¢$ %
con
¢¢& )
;
¢¢) *
SqlDataAdapter
££ 
da
££ !
=
££" #
new
££$ '
(
££' (
$str
££( :
,
££: ;
cn
££< >
)
££> ?
;
££? @
da
§§ 
.
§§ 
SelectCommand
§§  
.
§§  !
CommandType
§§! ,
=
§§- .
CommandType
§§/ :
.
§§: ;
StoredProcedure
§§; J
;
§§J K
da
•• 
.
•• 
SelectCommand
••  
.
••  !

Parameters
••! +
.
••+ ,
AddWithValue
••, 8
(
••8 9
$str
••9 A
,
••A B
uid
••C F
)
••F G
;
••G H
await
ßß 
cn
ßß 
.
ßß 
	OpenAsync
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
da
©© 
.
©© 
Fill
©© 
(
©© 
data
©© 
)
©© 
;
©© 
cn
™™ 
.
™™ 
Close
™™ 
(
™™ 
)
™™ 
;
™™ 
return
´´ 
data
´´ 
;
´´ 
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
)
ÆÆ 
{
ØØ 
if
∞∞ 
(
∞∞ 
cn
∞∞ 
.
∞∞ 
State
∞∞ 
==
∞∞ 
ConnectionState
∞∞  /
.
∞∞/ 0
Open
∞∞0 4
)
∞∞4 5
{
±± 
cn
≤≤ 
.
≤≤ 
Close
≤≤ 
(
≤≤ 
)
≤≤ 
;
≤≤ 
}
≥≥ 
return
µµ 
data
µµ 
;
µµ 
}
∂∂ 
}
∑∑ 	
public
ππ 
async
ππ 
Task
ππ 
<
ππ 
int
ππ 
>
ππ !
BD_Registrar_Evento
ππ 2
(
ππ2 3
Evento
ππ3 9
evento
ππ: @
)
ππ@ A
{
∫∫ 	
SqlConnection
ªª 
cn
ªª 
=
ªª 
new
ªª "
(
ªª" #
)
ªª# $
;
ªª$ %
int
ΩΩ 
	respuesta
ΩΩ 
;
ΩΩ 
try
øø 
{
¿¿ 
cn
¡¡ 
.
¡¡ 
ConnectionString
¡¡ #
=
¡¡$ %
con
¡¡& )
;
¡¡) *

SqlCommand
√√ 
cmd
√√ 
=
√√  
new
√√! $
(
√√$ %
$str
√√% 2
,
√√2 3
cn
√√4 6
)
√√6 7
{
ƒƒ 
CommandTimeout
≈≈ "
=
≈≈# $
$num
≈≈% '
,
≈≈' (
CommandType
∆∆ 
=
∆∆  !
CommandType
∆∆" -
.
∆∆- .
StoredProcedure
∆∆. =
}
«« 
;
«« 
cmd
…… 
.
…… 

Parameters
…… 
.
…… 
AddWithValue
…… +
(
……+ ,
$str
……, 4
,
……4 5
evento
……6 <
.
……< =
UserUid
……= D
)
……D E
;
……E F
cmd
   
.
   

Parameters
   
.
   
AddWithValue
   +
(
  + ,
$str
  , 6
,
  6 7
evento
  8 >
.
  > ?
User
  ? C
)
  C D
;
  D E
cmd
ÀÀ 
.
ÀÀ 

Parameters
ÀÀ 
.
ÀÀ 
AddWithValue
ÀÀ +
(
ÀÀ+ ,
$str
ÀÀ, 4
,
ÀÀ4 5
evento
ÀÀ6 <
.
ÀÀ< =
Title
ÀÀ= B
)
ÀÀB C
;
ÀÀC D
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ 
.
ÃÃ 
AddWithValue
ÃÃ +
(
ÃÃ+ ,
$str
ÃÃ, 4
,
ÃÃ4 5
evento
ÃÃ6 <
.
ÃÃ< =
Notes
ÃÃ= B
)
ÃÃB C
;
ÃÃC D
cmd
ÕÕ 
.
ÕÕ 

Parameters
ÕÕ 
.
ÕÕ 
AddWithValue
ÕÕ +
(
ÕÕ+ ,
$str
ÕÕ, 4
,
ÕÕ4 5
evento
ÕÕ6 <
.
ÕÕ< =
Start
ÕÕ= B
)
ÕÕB C
;
ÕÕC D
cmd
ŒŒ 
.
ŒŒ 

Parameters
ŒŒ 
.
ŒŒ 
AddWithValue
ŒŒ +
(
ŒŒ+ ,
$str
ŒŒ, 2
,
ŒŒ2 3
evento
ŒŒ4 :
.
ŒŒ: ;
End
ŒŒ; >
)
ŒŒ> ?
;
ŒŒ? @
cmd
œœ 
.
œœ 

Parameters
œœ 
.
œœ 
AddWithValue
œœ +
(
œœ+ ,
$str
œœ, 4
,
œœ4 5
evento
œœ6 <
.
œœ< =
IdCre
œœ= B
)
œœB C
;
œœC D
await
—— 
cn
—— 
.
—— 
	OpenAsync
—— "
(
——" #
)
——# $
;
——$ %
int
”” 
getValue
”” 
=
”” 
Convert
”” &
.
””& '
ToInt32
””' .
(
””. /
await
””/ 4
cmd
””5 8
.
””8 9 
ExecuteScalarAsync
””9 K
(
””K L
)
””L M
)
””M N
;
””N O
if
’’ 
(
’’ 
getValue
’’ 
>
’’ 
$num
’’  
)
’’  !
{
÷÷ 
	respuesta
◊◊ 
=
◊◊ 
getValue
◊◊  (
;
◊◊( )
}
ÿÿ 
else
ŸŸ 
{
⁄⁄ 
	respuesta
€€ 
=
€€ 
$num
€€  !
;
€€! "
}
‹‹ 
cn
ﬁﬁ 
.
ﬁﬁ 
Close
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
return
‡‡ 
	respuesta
‡‡  
;
‡‡  !
}
·· 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
)
‚‚ 
{
„„ 
if
‰‰ 
(
‰‰ 
cn
‰‰ 
.
‰‰ 
State
‰‰ 
==
‰‰ 
ConnectionState
‰‰  /
.
‰‰/ 0
Open
‰‰0 4
)
‰‰4 5
{
ÂÂ 
cn
ÊÊ 
.
ÊÊ 
Close
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
}
ÁÁ 
return
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
}
ÍÍ 
}
ÎÎ 	
public
ÌÌ 
async
ÌÌ 
Task
ÌÌ 
<
ÌÌ 
	DataTable
ÌÌ #
>
ÌÌ# $
BD_Buscar_Evento
ÌÌ% 5
(
ÌÌ5 6
int
ÌÌ6 9
Id_Not
ÌÌ: @
)
ÌÌ@ A
{
ÓÓ 	
SqlConnection
ÔÔ 
cn
ÔÔ 
=
ÔÔ 
new
ÔÔ "
(
ÔÔ" #
)
ÔÔ# $
;
ÔÔ$ %
	DataTable
 
data
 
=
 
new
  
(
  !
)
! "
;
" #
try
ÚÚ 
{
ÛÛ 
cn
ÙÙ 
.
ÙÙ 
ConnectionString
ÙÙ #
=
ÙÙ$ %
con
ÙÙ& )
;
ÙÙ) *
SqlDataAdapter
ıı 
da
ıı !
=
ıı" #
new
ıı$ '
(
ıı' (
$str
ıı( 9
,
ıı9 :
cn
ıı; =
)
ıı= >
;
ıı> ?
da
ˆˆ 
.
ˆˆ 
SelectCommand
ˆˆ  
.
ˆˆ  !
CommandType
ˆˆ! ,
=
ˆˆ- .
CommandType
ˆˆ/ :
.
ˆˆ: ;
StoredProcedure
ˆˆ; J
;
ˆˆJ K
da
˜˜ 
.
˜˜ 
SelectCommand
˜˜  
.
˜˜  !

Parameters
˜˜! +
.
˜˜+ ,
AddWithValue
˜˜, 8
(
˜˜8 9
$str
˜˜9 B
,
˜˜B C
Id_Not
˜˜D J
)
˜˜J K
;
˜˜K L
await
˘˘ 
cn
˘˘ 
.
˘˘ 
	OpenAsync
˘˘ "
(
˘˘" #
)
˘˘# $
;
˘˘$ %
da
˚˚ 
.
˚˚ 
Fill
˚˚ 
(
˚˚ 
data
˚˚ 
)
˚˚ 
;
˚˚ 
cn
¸¸ 
.
¸¸ 
Close
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
return
˛˛ 
data
˛˛ 
;
˛˛ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
)
ÅÅ 
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
cn
ÉÉ 
.
ÉÉ 
State
ÉÉ 
==
ÉÉ 
ConnectionState
ÉÉ  /
.
ÉÉ/ 0
Open
ÉÉ0 4
)
ÉÉ4 5
{
ÑÑ 
cn
ÖÖ 
.
ÖÖ 
Close
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
return
àà 
data
àà 
;
àà 
}
ââ 
}
ää 	
public
åå 
async
åå 
Task
åå 
<
åå 
int
åå 
>
åå *
BD_Registrar_Evento_Relacion
åå ;
(
åå; <
int
åå< ?
Id_Even
åå@ G
,
ååG H
int
ååI L
uid
ååM P
)
ååP Q
{
çç 	
SqlConnection
éé 
cn
éé 
=
éé 
new
éé "
(
éé" #
)
éé# $
;
éé$ %
int
êê 
	respuesta
êê 
;
êê 
try
íí 
{
ìì 
cn
îî 
.
îî 
ConnectionString
îî #
=
îî$ %
con
îî& )
;
îî) *

SqlCommand
ññ 
cmd
ññ 
=
ññ  
new
ññ! $
(
ññ$ %
$str
ññ% :
,
ññ: ;
cn
ññ< >
)
ññ> ?
{
óó 
CommandTimeout
òò "
=
òò# $
$num
òò% '
,
òò' (
CommandType
ôô 
=
ôô  !
CommandType
ôô" -
.
ôô- .
StoredProcedure
ôô. =
}
öö 
;
öö 
cmd
úú 
.
úú 

Parameters
úú 
.
úú 
AddWithValue
úú +
(
úú+ ,
$str
úú, 4
,
úú4 5
uid
úú6 9
)
úú9 :
;
úú: ;
cmd
ùù 
.
ùù 

Parameters
ùù 
.
ùù 
AddWithValue
ùù +
(
ùù+ ,
$str
ùù, 4
,
ùù4 5
Id_Even
ùù6 =
)
ùù= >
;
ùù> ?
await
üü 
cn
üü 
.
üü 
	OpenAsync
üü "
(
üü" #
)
üü# $
;
üü$ %
int
°° 
getValue
°° 
=
°° 
Convert
°° &
.
°°& '
ToInt32
°°' .
(
°°. /
await
°°/ 4
cmd
°°5 8
.
°°8 9 
ExecuteScalarAsync
°°9 K
(
°°K L
)
°°L M
)
°°M N
;
°°N O
if
££ 
(
££ 
getValue
££ 
>
££ 
$num
££  
)
££  !
{
§§ 
	respuesta
•• 
=
•• 
getValue
••  (
;
••( )
}
¶¶ 
else
ßß 
{
®® 
	respuesta
©© 
=
©© 
$num
©©  !
;
©©! "
}
™™ 
cn
¨¨ 
.
¨¨ 
Close
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
return
ÆÆ 
	respuesta
ÆÆ  
;
ÆÆ  !
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
)
∞∞ 
{
±± 
if
≤≤ 
(
≤≤ 
cn
≤≤ 
.
≤≤ 
State
≤≤ 
==
≤≤ 
ConnectionState
≤≤  /
.
≤≤/ 0
Open
≤≤0 4
)
≤≤4 5
{
≥≥ 
cn
¥¥ 
.
¥¥ 
Close
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
return
∑∑ 
$num
∑∑ 
;
∑∑ 
}
∏∏ 
}
ππ 	
public
ªª 
async
ªª 
Task
ªª 
<
ªª 
	DataTable
ªª #
>
ªª# $-
DB_Mostar_Todos_Usuarios_Evento
ªª% D
(
ªªD E
int
ªªE H
Id_Even
ªªI P
)
ªªP Q
{
ºº 	
SqlConnection
ΩΩ 
cn
ΩΩ 
=
ΩΩ 
new
ΩΩ "
(
ΩΩ" #
)
ΩΩ# $
;
ΩΩ$ %
	DataTable
ææ 
data
ææ 
=
ææ 
new
ææ  
(
ææ  !
)
ææ! "
;
ææ" #
try
¿¿ 
{
¡¡ 
cn
¬¬ 
.
¬¬ 
ConnectionString
¬¬ #
=
¬¬$ %
con
¬¬& )
;
¬¬) *
SqlDataAdapter
√√ 
da
√√ !
=
√√" #
new
√√$ '
(
√√' (
$str
√√( :
,
√√: ;
cn
√√< >
)
√√> ?
;
√√? @
da
ƒƒ 
.
ƒƒ 
SelectCommand
ƒƒ  
.
ƒƒ  !
CommandType
ƒƒ! ,
=
ƒƒ- .
CommandType
ƒƒ/ :
.
ƒƒ: ;
StoredProcedure
ƒƒ; J
;
ƒƒJ K
da
≈≈ 
.
≈≈ 
SelectCommand
≈≈  
.
≈≈  !

Parameters
≈≈! +
.
≈≈+ ,
AddWithValue
≈≈, 8
(
≈≈8 9
$str
≈≈9 A
,
≈≈A B
Id_Even
≈≈C J
)
≈≈J K
;
≈≈K L
await
«« 
cn
«« 
.
«« 
	OpenAsync
«« "
(
««" #
)
««# $
;
««$ %
da
…… 
.
…… 
Fill
…… 
(
…… 
data
…… 
)
…… 
;
…… 
cn
   
.
   
Close
   
(
   
)
   
;
   
return
ÀÀ 
data
ÀÀ 
;
ÀÀ 
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
)
ŒŒ 
{
œœ 
if
–– 
(
–– 
cn
–– 
.
–– 
State
–– 
==
–– 
ConnectionState
––  /
.
––/ 0
Open
––0 4
)
––4 5
{
—— 
cn
““ 
.
““ 
Close
““ 
(
““ 
)
““ 
;
““ 
}
”” 
return
’’ 
data
’’ 
;
’’ 
}
÷÷ 
}
◊◊ 	
public
ŸŸ 
async
ŸŸ 
Task
ŸŸ 
<
ŸŸ 
bool
ŸŸ 
>
ŸŸ )
BD_Eliminar_Evento_Relacion
ŸŸ  ;
(
ŸŸ; <
int
ŸŸ< ?
Id_Even
ŸŸ@ G
,
ŸŸG H
int
ŸŸI L
uid
ŸŸM P
)
ŸŸP Q
{
⁄⁄ 	
SqlConnection
€€ 
cn
€€ 
=
€€ 
new
€€ "
(
€€" #
)
€€# $
;
€€$ %
bool
‹‹ 
	respuesta
‹‹ 
=
‹‹ 
true
‹‹ !
;
‹‹! "
try
ﬁﬁ 
{
ﬂﬂ 
cn
‡‡ 
.
‡‡ 
ConnectionString
‡‡ #
=
‡‡$ %
con
‡‡& )
;
‡‡) *

SqlCommand
‚‚ 
cmd
‚‚ 
=
‚‚  
new
‚‚! $
(
‚‚$ %
$str
‚‚% C
,
‚‚C D
cn
‚‚E G
)
‚‚G H
{
„„ 
CommandTimeout
‰‰ "
=
‰‰# $
$num
‰‰% '
,
‰‰' (
CommandType
ÂÂ 
=
ÂÂ  !
CommandType
ÂÂ" -
.
ÂÂ- .
StoredProcedure
ÂÂ. =
}
ÊÊ 
;
ÊÊ 
cmd
ËË 
.
ËË 

Parameters
ËË 
.
ËË 
AddWithValue
ËË +
(
ËË+ ,
$str
ËË, 5
,
ËË5 6
Id_Even
ËË7 >
)
ËË> ?
;
ËË? @
cmd
ÈÈ 
.
ÈÈ 

Parameters
ÈÈ 
.
ÈÈ 
AddWithValue
ÈÈ +
(
ÈÈ+ ,
$str
ÈÈ, 5
,
ÈÈ5 6
uid
ÈÈ7 :
)
ÈÈ: ;
;
ÈÈ; <
await
ÎÎ 
cn
ÎÎ 
.
ÎÎ 
	OpenAsync
ÎÎ "
(
ÎÎ" #
)
ÎÎ# $
;
ÎÎ$ %
int
ÌÌ 
getValue
ÌÌ 
=
ÌÌ 
Convert
ÌÌ &
.
ÌÌ& '
ToInt32
ÌÌ' .
(
ÌÌ. /
await
ÌÌ/ 4
cmd
ÌÌ5 8
.
ÌÌ8 9"
ExecuteNonQueryAsync
ÌÌ9 M
(
ÌÌM N
)
ÌÌN O
)
ÌÌO P
;
ÌÌP Q
if
ÔÔ 
(
ÔÔ 
getValue
ÔÔ 
>
ÔÔ 
$num
ÔÔ  
)
ÔÔ  !
{
 
	respuesta
ÒÒ 
=
ÒÒ 
false
ÒÒ  %
;
ÒÒ% &
}
ÚÚ 
else
ÛÛ 
{
ÙÙ 
	respuesta
ıı 
=
ıı 
true
ıı  $
;
ıı$ %
}
ˆˆ 
cmd
¯¯ 
.
¯¯ 

Parameters
¯¯ 
.
¯¯ 
Clear
¯¯ $
(
¯¯$ %
)
¯¯% &
;
¯¯& '
cmd
˘˘ 
.
˘˘ 
Dispose
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
cn
˙˙ 
.
˙˙ 
Close
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
return
¸¸ 
	respuesta
¸¸  
;
¸¸  !
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
)
˛˛ 
{
ˇˇ 
if
ÄÄ 
(
ÄÄ 
cn
ÄÄ 
.
ÄÄ 
State
ÄÄ 
==
ÄÄ 
ConnectionState
ÄÄ  /
.
ÄÄ/ 0
Open
ÄÄ0 4
)
ÄÄ4 5
{
ÅÅ 
cn
ÇÇ 
.
ÇÇ 
Close
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
return
ÖÖ 
	respuesta
ÖÖ  
;
ÖÖ  !
}
ÜÜ 
}
áá 	
}
àà 
}ââ ¨F
TE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SDB_Notificacion.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 
SDB_Notificacion !
:" #
IDB_Notificacion$ 4
{ 
private

 
readonly

 
string

 
con

  #
=

$ %
$str

& t
;

t u
public 
async 
Task 
< 
bool 
> $
BD_Eliminar_Notificacion  8
(8 9
int9 <
Id_Not= C
,C D
intE H
Id_UsuI O
)O P
{ 	
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
bool 
	respuesta 
= 
true !
;! "
try 
{ 
cn 
. 
ConnectionString #
=$ %
con& )
;) *

SqlCommand 
cmd 
=  
new! $
($ %
$str% ?
,? @
cnA C
)C D
{ 
CommandTimeout "
=# $
$num% '
,' (
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
Id_Not7 =
)= >
;> ?
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
Id_Usu6 <
)< =
;= >
await 
cn 
. 
	OpenAsync "
(" #
)# $
;$ %
int   
getValue   
=   
Convert   &
.  & '
ToInt32  ' .
(  . /
await  / 4
cmd  5 8
.  8 9 
ExecuteNonQueryAsync  9 M
(  M N
)  N O
)  O P
;  P Q
if"" 
("" 
getValue"" 
>"" 
$num""  
)""  !
{## 
	respuesta$$ 
=$$ 
false$$  %
;$$% &
}%% 
else&& 
{'' 
	respuesta(( 
=(( 
true((  $
;(($ %
})) 
cmd++ 
.++ 

Parameters++ 
.++ 
Clear++ $
(++$ %
)++% &
;++& '
cmd,, 
.,, 
Dispose,, 
(,, 
),, 
;,, 
cn-- 
.-- 
Close-- 
(-- 
)-- 
;-- 
return// 
	respuesta//  
;//  !
}00 
catch11 
(11 
	Exception11 
)11 
{22 
if33 
(33 
cn33 
.33 
State33 
==33 
ConnectionState33  /
.33/ 0
Open330 4
)334 5
{44 
cn55 
.55 
Close55 
(55 
)55 
;55 
}66 
return88 
	respuesta88  
;88  !
}99 
}:: 	
public<< 
async<< 
Task<< 
<<< 
int<< 
><< %
BD_Registrar_Notificacion<< 8
(<<8 9 
NotificacionRegister<<9 M
notificacion<<N Z
)<<Z [
{== 	
SqlConnection>> 
cn>> 
=>> 
new>> "
(>>" #
)>># $
;>>$ %
int@@ 
	respuesta@@ 
;@@ 
tryBB 
{CC 

SqlCommandDD 
cmdDD 
=DD  
newDD! $
(DD$ %
)DD% &
;DD& '
cnEE 
.EE 
ConnectionStringEE #
=EE$ %
conEE& )
;EE) *
cmdFF 
.FF 
CommandTextFF 
=FF  !
$strFF" 7
;FF7 8
cmdGG 
.GG 

ConnectionGG 
=GG  
cnGG! #
;GG# $
cmdHH 
.HH 
CommandTimeoutHH "
=HH# $
$numHH% '
;HH' (
cmdII 
.II 
CommandTypeII 
=II  !
CommandTypeII" -
.II- .
StoredProcedureII. =
;II= >
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 4
,KK4 5
notificacionKK6 B
.KKB C
Id_UsuKKC I
)KKI J
;KKJ K
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 4
,LL4 5
notificacionLL6 B
.LLB C
Id_NotaLLC J
)LLJ K
;LLK L
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 4
,MM4 5
notificacionMM6 B
.MMB C
Id_CreeMMC J
)MMJ K
;MMK L
awaitOO 
cnOO 
.OO 
	OpenAsyncOO "
(OO" #
)OO# $
;OO$ %
intQQ 
getValueQQ 
=QQ 
ConvertQQ &
.QQ& '
ToInt32QQ' .
(QQ. /
awaitQQ/ 4
cmdQQ5 8
.QQ8 9
ExecuteScalarAsyncQQ9 K
(QQK L
)QQL M
)QQM N
;QQN O
ifSS 
(SS 
getValueSS 
>SS 
$numSS  
)SS  !
{TT 
	respuestaUU 
=UU 
getValueUU  (
;UU( )
}VV 
elseWW 
{XX 
	respuestaYY 
=YY 
$numYY  !
;YY! "
}ZZ 
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Clear\\ $
(\\$ %
)\\% &
;\\& '
cmd]] 
.]] 
Dispose]] 
(]] 
)]] 
;]] 
cn^^ 
.^^ 
Close^^ 
(^^ 
)^^ 
;^^ 
}__ 
catch`` 
(`` 
	Exception`` 
)`` 
{aa 
ifcc 
(cc 
cncc 
.cc 
Statecc 
==cc 
ConnectionStatecc  /
.cc/ 0
Opencc0 4
)cc4 5
{dd 
cnee 
.ee 
Closeee 
(ee 
)ee 
;ee 
}ff 
returnhh 
$numhh 
;hh 
}ii 
returnkk 
	respuestakk 
;kk 
}ll 	
publicnn 
asyncnn 
Tasknn 
<nn 
	DataTablenn #
>nn# $0
$DB_Mostar_Todas_Notificacion_Usuarionn% I
(nnI J
intnnJ M
Id_UsunnN T
)nnT U
{oo 	
SqlConnectionpp 
cnpp 
=pp 
newpp "
(pp" #
)pp# $
;pp$ %
	DataTableqq 
dataqq 
=qq 
newqq  
(qq  !
)qq! "
;qq" #
tryss 
{tt 
cnuu 
.uu 
ConnectionStringuu #
=uu$ %
conuu& )
;uu) *
SqlDataAdaptervv 
davv !
=vv" #
newvv$ '
(vv' (
$strvv( B
,vvB C
cnvvD F
)vvF G
;vvG H
daww 
.ww 
SelectCommandww  
.ww  !
CommandTypeww! ,
=ww- .
CommandTypeww/ :
.ww: ;
StoredProcedureww; J
;wwJ K
daxx 
.xx 
SelectCommandxx  
.xx  !

Parametersxx! +
.xx+ ,
AddWithValuexx, 8
(xx8 9
$strxx9 A
,xxA B
Id_UsuxxC I
)xxI J
;xxJ K
awaitzz 
cnzz 
.zz 
	OpenAsynczz "
(zz" #
)zz# $
;zz$ %
da|| 
.|| 
Fill|| 
(|| 
data|| 
)|| 
;|| 
cn}} 
.}} 
Close}} 
(}} 
)}} 
;}} 
return 
data 
; 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
)
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
cn
ÑÑ 
.
ÑÑ 
State
ÑÑ 
==
ÑÑ 
ConnectionState
ÑÑ  /
.
ÑÑ/ 0
Open
ÑÑ0 4
)
ÑÑ4 5
{
ÖÖ 
cn
ÜÜ 
.
ÜÜ 
Close
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
return
ââ 
data
ââ 
;
ââ 
}
ää 
}
ãã 	
}
åå 
}çç 