Ø
OE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IBdAction.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 
	IBdAction 
{ 
Task 
< 
bool 
> $
BD_Eliminar_Notificacion +
(+ ,
int, /
uid0 3
)3 4
;4 5
} 
} °
PE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IBdUsuario.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 

IBdUsuario 
{ 
Task 
< 
bool 
> 
BD_Buscar_Correo #
(# $
string$ *
email+ 0
)0 1
;1 2
Task		 
<		 
int		 
>		  
BD_Registrar_Usuario		 &
(		& '
UsuarioRegister		' 6
usuario		7 >
)		> ?
;		? @
Task

 
<

 
	DataTable

 
>

 
DB_Login

  
(

  !
string

! '
email

( -
)

- .
;

. /
} 
} §
OE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IDbEvento.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 
	IDbEvento 
{ 
Task 
< 
bool 
> 
BD_Editar_Evento #
(# $
Evento$ *
evento+ 1
)1 2
;2 3
Task		 
<		 
bool		 
>		 
BD_Eliminar_Evento		 %
(		% &
int		& )
Id_Even		* 1
,		1 2
int		3 6
uid		7 :
)		: ;
;		; <
Task

 
<

 
bool

 
>

 '
BD_Eliminar_Evento_Relacion

 .
(

. /
int

/ 2
Id_Even

3 :
,

: ;
int

< ?
uid

@ C
)

C D
;

D E
Task 
< 
bool 
> &
BD_Eliminar_Evento_Usuario -
(- .
int. 1
Id_Not2 8
)8 9
;9 :
Task 
< 
	DataTable 
> *
DB_Mostar_Todos_Evento_Usuario 6
(6 7
int7 :
uid; >
)> ?
;? @
Task 
< 
	DataTable 
> +
DB_Mostar_Todos_Usuarios_Evento 7
(7 8
int8 ;
Id_Even< C
)C D
;D E
Task 
< 
int 
> 
BD_Registrar_Evento %
(% &
Evento& ,
evento- 3
)3 4
;4 5
Task 
< 
int 
> (
BD_Registrar_Evento_Relacion .
(. /
int/ 2
Id_Even3 :
,: ;
int< ?
uid@ C
)C D
;D E
Task 
< 
	DataTable 
> 
BD_Buscar_Evento (
(( )
int) ,
Id_Not- 3
)3 4
;4 5
} 
} é
UE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\interfaces\IDbNotificacion.cs
	namespace 	

Capa_Datos
 
{ 
public 

	interface 
IDbNotificacion $
{ 
Task 
< 
int 
> %
BD_Registrar_Notificacion +
(+ , 
NotificacionRegister, @
notificacionA M
)M N
;N O
Task		 
<		 
bool		 
>		 $
BD_Eliminar_Notificacion		 +
(		+ ,
int		, /
Id_Not		0 6
,		6 7
int		8 ;
Id_Usu		< B
)		B C
;		C D
Task

 
<

 
	DataTable

 
>

 0
$DB_Mostar_Todas_Notificacion_Usuario

 <
(

< =
int

= @
Id_Usu

A G
)

G H
;

H I
} 
} ¥
ME:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SbdAction.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 
	SbdAction 
: 
	IBdAction &
{ 
private 
readonly 
string 
con  #
=$ %
$str& t
;t u
public

 
async

 
Task

 
<

 
bool

 
>

 $
BD_Eliminar_Notificacion

  8
(

8 9
int

9 <
uid

= @
)

@ A
{ 	
bool 
delete 
= 
true 
; 
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
try 
{ 
cn 
. 
ConnectionString #
=$ %
con& )
;) *

SqlCommand 
cmd 
=  
new! $
($ %
$str% C
,C D
cnE G
)G H
{ 
CommandTimeout "
=# $
$num% '
,' (
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
uid6 9
)9 :
;: ;
await 
cn 
. 
	OpenAsync "
(" #
)# $
;$ %
int 
getValue 
= 
Convert &
.& '
ToInt32' .
(. /
await/ 4
cmd5 8
.8 9 
ExecuteNonQueryAsync9 M
(M N
)N O
)O P
;P Q
if 
( 
getValue 
> 
$num  
)  !
{   
delete!! 
=!! 
false!! "
;!!" #
}"" 
else## 
{$$ 
delete%% 
=%% 
true%% !
;%%! "
}&& 
cmd(( 
.(( 

Parameters(( 
.(( 
Clear(( $
((($ %
)((% &
;((& '
cmd)) 
.)) 
Dispose)) 
()) 
))) 
;)) 
cn** 
.** 
Close** 
(** 
)** 
;** 
return,, 
delete,, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
).. 
{// 
if00 
(00 
cn00 
.00 
State00 
==00 
ConnectionState00  /
.00/ 0
Open000 4
)004 5
{11 
cn22 
.22 
Close22 
(22 
)22 
;22 
}33 
return55 
delete55 
;55 
}66 
}77 	
}88 
}99 ”F
NE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SbdUsuario.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 

SbdUsuario 
: 

IBdUsuario (
{ 
private		 
readonly		 
string		 
con		  #
=		$ %
$str		& t
;		t u
public 
async 
Task 
< 
bool 
> 
BD_Buscar_Correo  0
(0 1
string1 7
email8 =
)= >
{ 	
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
bool 
	respuesta 
= 
false "
;" #
try 
{ 

SqlCommand 
cmd 
=  
new! $
($ %
)% &
;& '
cn 
. 
ConnectionString #
=$ %
con& )
;) *
cmd 
. 
CommandText 
=  !
$str" 5
;5 6
cmd 
. 

Connection 
=  
cn! #
;# $
cmd 
. 
CommandTimeout "
=# $
$num% '
;' (
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
email6 ;
); <
;< =
await 
cn 
. 
	OpenAsync "
(" #
)# $
;$ %
int 
getValue 
= 
Convert &
.& '
ToInt32' .
(. /
cmd/ 2
.2 3
ExecuteScalar3 @
(@ A
)A B
)B C
;C D
if!! 
(!! 
getValue!! 
>!! 
$num!!  
)!!  !
{"" 
	respuesta## 
=## 
true##  $
;##$ %
}$$ 
else%% 
{&& 
	respuesta'' 
='' 
false''  %
;''% &
}(( 
cmd** 
.** 

Parameters** 
.** 
Clear** $
(**$ %
)**% &
;**& '
cmd++ 
.++ 
Dispose++ 
(++ 
)++ 
;++ 
cn,, 
.,, 
Close,, 
(,, 
),, 
;,, 
return.. 
	respuesta..  
;..  !
}// 
catch00 
(00 
	Exception00 
)00 
{11 
if33 
(33 
cn33 
.33 
State33 
==33 
ConnectionState33  /
.33/ 0
Open330 4
)334 5
{44 
cn55 
.55 
Close55 
(55 
)55 
;55 
}66 
return88 
	respuesta88  
;88  !
}99 
}:: 	
public<< 
async<< 
Task<< 
<<< 
int<< 
><<  
BD_Registrar_Usuario<< 3
(<<3 4
UsuarioRegister<<4 C
usuario<<D K
)<<K L
{== 	
SqlConnection>> 
cn>> 
=>> 
new>> "
(>>" #
)>># $
;>>$ %
int@@ 
	respuesta@@ 
;@@ 
tryBB 
{CC 

SqlCommandDD 
cmdDD 
=DD  
newDD! $
(DD$ %
)DD% &
;DD& '
cnEE 
.EE 
ConnectionStringEE #
=EE$ %
conEE& )
;EE) *
cmdFF 
.FF 
CommandTextFF 
=FF  !
$strFF" 2
;FF2 3
cmdGG 
.GG 

ConnectionGG 
=GG  
cnGG! #
;GG# $
cmdHH 
.HH 
CommandTimeoutHH "
=HH# $
$numHH% '
;HH' (
cmdII 
.II 
CommandTypeII 
=II  !
CommandTypeII" -
.II- .
StoredProcedureII. =
;II= >
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 3
,KK3 4
usuarioKK5 <
.KK< =
NameKK= A
.KKA B
TrimKKB F
(KKF G
)KKG H
)KKH I
;KKI J
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 7
,LL7 8
usuarioLL9 @
.LL@ A
PasswordLLA I
.LLI J
TrimLLJ N
(LLN O
)LLO P
)LLP Q
;LLQ R
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 4
,MM4 5
usuarioMM6 =
.MM= >
EmailMM> C
.MMC D
TrimMMD H
(MMH I
)MMI J
)MMJ K
;MMK L
awaitOO 
cnOO 
.OO 
	OpenAsyncOO "
(OO" #
)OO# $
;OO$ %
intQQ 
getValueQQ 
=QQ 
ConvertQQ &
.QQ& '
ToInt32QQ' .
(QQ. /
awaitQQ/ 4
cmdQQ5 8
.QQ8 9
ExecuteScalarAsyncQQ9 K
(QQK L
)QQL M
)QQM N
;QQN O
ifSS 
(SS 
getValueSS 
>SS 
$numSS  
)SS  !
{TT 
	respuestaUU 
=UU 
getValueUU  (
;UU( )
}VV 
elseWW 
{XX 
	respuestaYY 
=YY 
$numYY  !
;YY! "
}ZZ 
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Clear\\ $
(\\$ %
)\\% &
;\\& '
cmd]] 
.]] 
Dispose]] 
(]] 
)]] 
;]] 
cn^^ 
.^^ 
Close^^ 
(^^ 
)^^ 
;^^ 
}__ 
catch`` 
(`` 
	Exception`` 
)`` 
{aa 
ifcc 
(cc 
cncc 
.cc 
Statecc 
==cc 
ConnectionStatecc  /
.cc/ 0
Opencc0 4
)cc4 5
{dd 
cnee 
.ee 
Closeee 
(ee 
)ee 
;ee 
}ff 
returnhh 
$numhh 
;hh 
}ii 
returnkk 
	respuestakk 
;kk 
}ll 	
publicnn 
asyncnn 
Tasknn 
<nn 
	DataTablenn #
>nn# $
DB_Loginnn% -
(nn- .
stringnn. 4
emailnn5 :
)nn: ;
{oo 	
SqlConnectionpp 
cnpp 
=pp 
newpp "
(pp" #
)pp# $
;pp$ %
	DataTableqq 
dataqq 
=qq 
newqq  
(qq  !
)qq! "
;qq" #
tryss 
{tt 
cnuu 
.uu 
ConnectionStringuu #
=uu$ %
conuu& )
;uu) *
SqlDataAdaptervv 
davv !
=vv" #
newvv$ '
(vv' (
$strvv( :
,vv: ;
cnvv< >
)vv> ?
;vv? @
daww 
.ww 
SelectCommandww  
.ww  !
CommandTypeww! ,
=ww- .
CommandTypeww/ :
.ww: ;
StoredProcedureww; J
;wwJ K
daxx 
.xx 
SelectCommandxx  
.xx  !

Parametersxx! +
.xx+ ,
AddWithValuexx, 8
(xx8 9
$strxx9 A
,xxA B
emailxxC H
)xxH I
;xxI J
awaitzz 
cnzz 
.zz 
	OpenAsynczz "
(zz" #
)zz# $
;zz$ %
da|| 
.|| 
Fill|| 
(|| 
data|| 
)|| 
;|| 
cn}} 
.}} 
Close}} 
(}} 
)}} 
;}} 
return~~ 
data~~ 
;~~ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
)
ÅÅ 
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
cn
ÉÉ 
.
ÉÉ 
State
ÉÉ 
==
ÉÉ 
ConnectionState
ÉÉ  /
.
ÉÉ/ 0
Open
ÉÉ0 4
)
ÉÉ4 5
{
ÑÑ 
cn
ÖÖ 
.
ÖÖ 
Close
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
return
àà 
data
àà 
;
àà 
}
ââ 
}
ää 	
}
ãã 
}åå íŸ
ME:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SdbEvento.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 
	SdbEvento 
: 
	IDbEvento &
{ 
private		 
readonly		 
string		 
con		  #
=		$ %
$str		& t
;		t u
public 
async 
Task 
< 
bool 
> 
BD_Editar_Evento  0
(0 1
Evento1 7
evento8 >
)> ?
{ 	
bool 
	respuesta 
= 
false "
;" #
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
try 
{ 
cn 
. 
ConnectionString #
=$ %
con& )
;) *

SqlCommand 
cmd 
=  
new! $
($ %
$str% 5
,5 6
cn7 9
)9 :
{ 
CommandTimeout "
=# $
$num% '
,' (
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Id= ?
)? @
;@ A
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
UserUid= D
)D E
;E F
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 6
,6 7
evento8 >
.> ?
User? C
)C D
;D E
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Title= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Notes= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
evento6 <
.< =
Start= B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 2
,2 3
evento4 :
.: ;
End; >
)> ?
;? @
await!! 
cn!! 
.!! 
	OpenAsync!! "
(!!" #
)!!# $
;!!$ %
int## 
getValue## 
=## 
Convert## &
.##& '
ToInt32##' .
(##. /
await##/ 4
cmd##5 8
.##8 9 
ExecuteNonQueryAsync##9 M
(##M N
)##N O
)##O P
;##P Q
if%% 
(%% 
getValue%% 
>%% 
$num%%  
)%%  !
{&& 
	respuesta'' 
='' 
false''  %
;''% &
}(( 
else)) 
{** 
	respuesta++ 
=++ 
true++  $
;++$ %
},, 
cn.. 
... 
Close.. 
(.. 
).. 
;.. 
return00 
	respuesta00  
;00  !
}11 
catch22 
(22 
	Exception22 
)22 
{33 
if44 
(44 
cn44 
.44 
State44 
==44 
ConnectionState44  /
.44/ 0
Open440 4
)444 5
{55 
cn66 
.66 
Close66 
(66 
)66 
;66 
}77 
return99 
	respuesta99  
;99  !
}:: 
};; 	
public== 
async== 
Task== 
<== 
bool== 
>== 
BD_Eliminar_Evento==  2
(==2 3
int==3 6
Id_Even==7 >
,==> ?
int==@ C
uid==D G
)==G H
{>> 	
bool?? 
	respuesta?? 
=?? 
true?? !
;??! "
SqlConnection@@ 
cn@@ 
=@@ 
new@@ "
(@@" #
)@@# $
;@@$ %
tryAA 
{BB 
cnDD 
.DD 
ConnectionStringDD #
=DD$ %
conDD& )
;DD) *

SqlCommandFF 
cmdFF 
=FF  
newFF! $
(FF$ %
$strFF% 7
,FF7 8
cnFF9 ;
)FF; <
{GG 
CommandTimeoutHH "
=HH# $
$numHH% '
,HH' (
CommandTypeII 
=II  !
CommandTypeII" -
.II- .
StoredProcedureII. =
}JJ 
;JJ 
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 4
,LL4 5
Id_EvenLL6 =
)LL= >
;LL> ?
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 4
,MM4 5
uidMM6 9
)MM9 :
;MM: ;
awaitOO 
cnOO 
.OO 
	OpenAsyncOO "
(OO" #
)OO# $
;OO$ %
intQQ 
getValueQQ 
=QQ 
ConvertQQ &
.QQ& '
ToInt32QQ' .
(QQ. /
awaitQQ/ 4
cmdQQ5 8
.QQ8 9 
ExecuteNonQueryAsyncQQ9 M
(QQM N
)QQN O
)QQO P
;QQP Q
ifSS 
(SS 
getValueSS 
>SS 
$numSS  
)SS  !
{TT 
	respuestaUU 
=UU 
falseUU  %
;UU% &
}VV 
elseWW 
{XX 
	respuestaYY 
=YY 
trueYY  $
;YY$ %
}ZZ 
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Clear\\ $
(\\$ %
)\\% &
;\\& '
cmd]] 
.]] 
Dispose]] 
(]] 
)]] 
;]] 
cn^^ 
.^^ 
Close^^ 
(^^ 
)^^ 
;^^ 
return`` 
	respuesta``  
;``  !
}aa 
catchbb 
(bb 
	Exceptionbb 
)bb 
{cc 
ifdd 
(dd 
cndd 
.dd 
Statedd 
==dd 
ConnectionStatedd  /
.dd/ 0
Opendd0 4
)dd4 5
{ee 
cnff 
.ff 
Closeff 
(ff 
)ff 
;ff 
}gg 
returnii 
	respuestaii  
;ii  !
}jj 
}kk 	
publicmm 
asyncmm 
Taskmm 
<mm 
boolmm 
>mm &
BD_Eliminar_Evento_Usuariomm  :
(mm: ;
intmm; >
Id_Notmm? E
)mmE F
{nn 	
booloo 
	respuestaoo 
=oo 
trueoo !
;oo! "
SqlConnectionpp 
cnpp 
=pp 
newpp "
(pp" #
)pp# $
;pp$ %
tryqq 
{rr 
cntt 
.tt 
ConnectionStringtt #
=tt$ %
contt& )
;tt) *

SqlCommandvv 
cmdvv 
=vv  
newvv! $
(vv$ %
$strvv% ?
,vv? @
cnvvA C
)vvC D
{ww 
CommandTimeoutxx "
=xx# $
$numxx% '
,xx' (
CommandTypeyy 
=yy  !
CommandTypeyy" -
.yy- .
StoredProcedureyy. =
}zz 
;zz 
cmd|| 
.|| 

Parameters|| 
.|| 
AddWithValue|| +
(||+ ,
$str||, 5
,||5 6
Id_Not||7 =
)||= >
;||> ?
await~~ 
cn~~ 
.~~ 
	OpenAsync~~ "
(~~" #
)~~# $
;~~$ %
int
ÄÄ 
getValue
ÄÄ 
=
ÄÄ 
Convert
ÄÄ &
.
ÄÄ& '
ToInt32
ÄÄ' .
(
ÄÄ. /
await
ÄÄ/ 4
cmd
ÄÄ5 8
.
ÄÄ8 9"
ExecuteNonQueryAsync
ÄÄ9 M
(
ÄÄM N
)
ÄÄN O
)
ÄÄO P
;
ÄÄP Q
if
ÇÇ 
(
ÇÇ 
getValue
ÇÇ 
>
ÇÇ 
$num
ÇÇ  
)
ÇÇ  !
{
ÉÉ 
	respuesta
ÑÑ 
=
ÑÑ 
false
ÑÑ  %
;
ÑÑ% &
}
ÖÖ 
else
ÜÜ 
{
áá 
	respuesta
àà 
=
àà 
true
àà  $
;
àà$ %
}
ââ 
cmd
ãã 
.
ãã 

Parameters
ãã 
.
ãã 
Clear
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
cmd
åå 
.
åå 
Dispose
åå 
(
åå 
)
åå 
;
åå 
cn
çç 
.
çç 
Close
çç 
(
çç 
)
çç 
;
çç 
return
èè 
	respuesta
èè  
;
èè  !
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
)
ëë 
{
íí 
if
ìì 
(
ìì 
cn
ìì 
.
ìì 
State
ìì 
==
ìì 
ConnectionState
ìì  /
.
ìì/ 0
Open
ìì0 4
)
ìì4 5
{
îî 
cn
ïï 
.
ïï 
Close
ïï 
(
ïï 
)
ïï 
;
ïï 
}
ññ 
return
òò 
	respuesta
òò  
;
òò  !
}
ôô 
}
öö 	
public
úú 
async
úú 
Task
úú 
<
úú 
	DataTable
úú #
>
úú# $,
DB_Mostar_Todos_Evento_Usuario
úú% C
(
úúC D
int
úúD G
uid
úúH K
)
úúK L
{
ùù 	
	DataTable
ûû 
data
ûû 
=
ûû 
new
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
SqlConnection
üü 
cn
üü 
=
üü 
new
üü "
(
üü" #
)
üü# $
;
üü$ %
try
†† 
{
°° 
cn
¢¢ 
.
¢¢ 
ConnectionString
¢¢ #
=
¢¢$ %
con
¢¢& )
;
¢¢) *
SqlDataAdapter
££ 
da
££ !
=
££" #
new
££$ '
(
££' (
$str
££( :
,
££: ;
cn
££< >
)
££> ?
;
££? @
da
§§ 
.
§§ 
SelectCommand
§§  
.
§§  !
CommandType
§§! ,
=
§§- .
CommandType
§§/ :
.
§§: ;
StoredProcedure
§§; J
;
§§J K
da
•• 
.
•• 
SelectCommand
••  
.
••  !

Parameters
••! +
.
••+ ,
AddWithValue
••, 8
(
••8 9
$str
••9 A
,
••A B
uid
••C F
)
••F G
;
••G H
await
ßß 
cn
ßß 
.
ßß 
	OpenAsync
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
da
©© 
.
©© 
Fill
©© 
(
©© 
data
©© 
)
©© 
;
©© 
cn
™™ 
.
™™ 
Close
™™ 
(
™™ 
)
™™ 
;
™™ 
return
´´ 
data
´´ 
;
´´ 
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
)
ÆÆ 
{
ØØ 
if
∞∞ 
(
∞∞ 
cn
∞∞ 
.
∞∞ 
State
∞∞ 
==
∞∞ 
ConnectionState
∞∞  /
.
∞∞/ 0
Open
∞∞0 4
)
∞∞4 5
{
±± 
cn
≤≤ 
.
≤≤ 
Close
≤≤ 
(
≤≤ 
)
≤≤ 
;
≤≤ 
}
≥≥ 
return
µµ 
data
µµ 
;
µµ 
}
∂∂ 
}
∑∑ 	
public
ππ 
async
ππ 
Task
ππ 
<
ππ 
int
ππ 
>
ππ !
BD_Registrar_Evento
ππ 2
(
ππ2 3
Evento
ππ3 9
evento
ππ: @
)
ππ@ A
{
∫∫ 	
int
ªª 
	respuesta
ªª 
;
ªª 
SqlConnection
ºº 
cn
ºº 
=
ºº 
new
ºº "
(
ºº" #
)
ºº# $
;
ºº$ %
try
ΩΩ 
{
ææ 
cn
øø 
.
øø 
ConnectionString
øø #
=
øø$ %
con
øø& )
;
øø) *

SqlCommand
¡¡ 
cmd
¡¡ 
=
¡¡  
new
¡¡! $
(
¡¡$ %
$str
¡¡% 2
,
¡¡2 3
cn
¡¡4 6
)
¡¡6 7
{
¬¬ 
CommandTimeout
√√ "
=
√√# $
$num
√√% '
,
√√' (
CommandType
ƒƒ 
=
ƒƒ  !
CommandType
ƒƒ" -
.
ƒƒ- .
StoredProcedure
ƒƒ. =
}
≈≈ 
;
≈≈ 
cmd
«« 
.
«« 

Parameters
«« 
.
«« 
AddWithValue
«« +
(
««+ ,
$str
««, 4
,
««4 5
evento
««6 <
.
««< =
UserUid
««= D
)
««D E
;
««E F
cmd
»» 
.
»» 

Parameters
»» 
.
»» 
AddWithValue
»» +
(
»»+ ,
$str
»», 6
,
»»6 7
evento
»»8 >
.
»»> ?
User
»»? C
)
»»C D
;
»»D E
cmd
…… 
.
…… 

Parameters
…… 
.
…… 
AddWithValue
…… +
(
……+ ,
$str
……, 4
,
……4 5
evento
……6 <
.
……< =
Title
……= B
)
……B C
;
……C D
cmd
   
.
   

Parameters
   
.
   
AddWithValue
   +
(
  + ,
$str
  , 4
,
  4 5
evento
  6 <
.
  < =
Notes
  = B
)
  B C
;
  C D
cmd
ÀÀ 
.
ÀÀ 

Parameters
ÀÀ 
.
ÀÀ 
AddWithValue
ÀÀ +
(
ÀÀ+ ,
$str
ÀÀ, 4
,
ÀÀ4 5
evento
ÀÀ6 <
.
ÀÀ< =
Start
ÀÀ= B
)
ÀÀB C
;
ÀÀC D
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ 
.
ÃÃ 
AddWithValue
ÃÃ +
(
ÃÃ+ ,
$str
ÃÃ, 2
,
ÃÃ2 3
evento
ÃÃ4 :
.
ÃÃ: ;
End
ÃÃ; >
)
ÃÃ> ?
;
ÃÃ? @
cmd
ÕÕ 
.
ÕÕ 

Parameters
ÕÕ 
.
ÕÕ 
AddWithValue
ÕÕ +
(
ÕÕ+ ,
$str
ÕÕ, 4
,
ÕÕ4 5
evento
ÕÕ6 <
.
ÕÕ< =
IdCre
ÕÕ= B
)
ÕÕB C
;
ÕÕC D
await
œœ 
cn
œœ 
.
œœ 
	OpenAsync
œœ "
(
œœ" #
)
œœ# $
;
œœ$ %
int
—— 
getValue
—— 
=
—— 
Convert
—— &
.
——& '
ToInt32
——' .
(
——. /
await
——/ 4
cmd
——5 8
.
——8 9 
ExecuteScalarAsync
——9 K
(
——K L
)
——L M
)
——M N
;
——N O
if
”” 
(
”” 
getValue
”” 
>
”” 
$num
””  
)
””  !
{
‘‘ 
	respuesta
’’ 
=
’’ 
getValue
’’  (
;
’’( )
}
÷÷ 
else
◊◊ 
{
ÿÿ 
	respuesta
ŸŸ 
=
ŸŸ 
$num
ŸŸ  !
;
ŸŸ! "
}
⁄⁄ 
cn
‹‹ 
.
‹‹ 
Close
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
return
ﬁﬁ 
	respuesta
ﬁﬁ  
;
ﬁﬁ  !
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
)
‡‡ 
{
·· 
if
‚‚ 
(
‚‚ 
cn
‚‚ 
.
‚‚ 
State
‚‚ 
==
‚‚ 
ConnectionState
‚‚  /
.
‚‚/ 0
Open
‚‚0 4
)
‚‚4 5
{
„„ 
cn
‰‰ 
.
‰‰ 
Close
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
}
ÂÂ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ËË 
}
ÈÈ 	
public
ÎÎ 
async
ÎÎ 
Task
ÎÎ 
<
ÎÎ 
	DataTable
ÎÎ #
>
ÎÎ# $
BD_Buscar_Evento
ÎÎ% 5
(
ÎÎ5 6
int
ÎÎ6 9
Id_Not
ÎÎ: @
)
ÎÎ@ A
{
ÏÏ 	
	DataTable
ÌÌ 
data
ÌÌ 
=
ÌÌ 
new
ÌÌ  
(
ÌÌ  !
)
ÌÌ! "
;
ÌÌ" #
SqlConnection
ÓÓ 
cn
ÓÓ 
=
ÓÓ 
new
ÓÓ "
(
ÓÓ" #
)
ÓÓ# $
;
ÓÓ$ %
try
ÔÔ 
{
 
cn
ÒÒ 
.
ÒÒ 
ConnectionString
ÒÒ #
=
ÒÒ$ %
con
ÒÒ& )
;
ÒÒ) *
SqlDataAdapter
ÚÚ 
da
ÚÚ !
=
ÚÚ" #
new
ÚÚ$ '
(
ÚÚ' (
$str
ÚÚ( 9
,
ÚÚ9 :
cn
ÚÚ; =
)
ÚÚ= >
;
ÚÚ> ?
da
ÛÛ 
.
ÛÛ 
SelectCommand
ÛÛ  
.
ÛÛ  !
CommandType
ÛÛ! ,
=
ÛÛ- .
CommandType
ÛÛ/ :
.
ÛÛ: ;
StoredProcedure
ÛÛ; J
;
ÛÛJ K
da
ÙÙ 
.
ÙÙ 
SelectCommand
ÙÙ  
.
ÙÙ  !

Parameters
ÙÙ! +
.
ÙÙ+ ,
AddWithValue
ÙÙ, 8
(
ÙÙ8 9
$str
ÙÙ9 B
,
ÙÙB C
Id_Not
ÙÙD J
)
ÙÙJ K
;
ÙÙK L
await
ˆˆ 
cn
ˆˆ 
.
ˆˆ 
	OpenAsync
ˆˆ "
(
ˆˆ" #
)
ˆˆ# $
;
ˆˆ$ %
da
¯¯ 
.
¯¯ 
Fill
¯¯ 
(
¯¯ 
data
¯¯ 
)
¯¯ 
;
¯¯ 
cn
˘˘ 
.
˘˘ 
Close
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
return
˚˚ 
data
˚˚ 
;
˚˚ 
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
)
˛˛ 
{
ˇˇ 
if
ÄÄ 
(
ÄÄ 
cn
ÄÄ 
.
ÄÄ 
State
ÄÄ 
==
ÄÄ 
ConnectionState
ÄÄ  /
.
ÄÄ/ 0
Open
ÄÄ0 4
)
ÄÄ4 5
{
ÅÅ 
cn
ÇÇ 
.
ÇÇ 
Close
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
return
ÖÖ 
data
ÖÖ 
;
ÖÖ 
}
ÜÜ 
}
áá 	
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
int
ââ 
>
ââ *
BD_Registrar_Evento_Relacion
ââ ;
(
ââ; <
int
ââ< ?
Id_Even
ââ@ G
,
ââG H
int
ââI L
uid
ââM P
)
ââP Q
{
ää 	
int
ãã 
	respuesta
ãã 
;
ãã 
SqlConnection
åå 
cn
åå 
=
åå 
new
åå "
(
åå" #
)
åå# $
;
åå$ %
try
éé 
{
èè 
cn
êê 
.
êê 
ConnectionString
êê #
=
êê$ %
con
êê& )
;
êê) *

SqlCommand
íí 
cmd
íí 
=
íí  
new
íí! $
(
íí$ %
$str
íí% :
,
íí: ;
cn
íí< >
)
íí> ?
{
ìì 
CommandTimeout
îî "
=
îî# $
$num
îî% '
,
îî' (
CommandType
ïï 
=
ïï  !
CommandType
ïï" -
.
ïï- .
StoredProcedure
ïï. =
}
ññ 
;
ññ 
cmd
òò 
.
òò 

Parameters
òò 
.
òò 
AddWithValue
òò +
(
òò+ ,
$str
òò, 4
,
òò4 5
uid
òò6 9
)
òò9 :
;
òò: ;
cmd
ôô 
.
ôô 

Parameters
ôô 
.
ôô 
AddWithValue
ôô +
(
ôô+ ,
$str
ôô, 4
,
ôô4 5
Id_Even
ôô6 =
)
ôô= >
;
ôô> ?
await
õõ 
cn
õõ 
.
õõ 
	OpenAsync
õõ "
(
õõ" #
)
õõ# $
;
õõ$ %
int
ùù 
getValue
ùù 
=
ùù 
Convert
ùù &
.
ùù& '
ToInt32
ùù' .
(
ùù. /
await
ùù/ 4
cmd
ùù5 8
.
ùù8 9 
ExecuteScalarAsync
ùù9 K
(
ùùK L
)
ùùL M
)
ùùM N
;
ùùN O
if
üü 
(
üü 
getValue
üü 
>
üü 
$num
üü  
)
üü  !
{
†† 
	respuesta
°° 
=
°° 
getValue
°°  (
;
°°( )
}
¢¢ 
else
££ 
{
§§ 
	respuesta
•• 
=
•• 
$num
••  !
;
••! "
}
¶¶ 
cn
®® 
.
®® 
Close
®® 
(
®® 
)
®® 
;
®® 
return
™™ 
	respuesta
™™  
;
™™  !
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
)
¨¨ 
{
≠≠ 
if
ÆÆ 
(
ÆÆ 
cn
ÆÆ 
.
ÆÆ 
State
ÆÆ 
==
ÆÆ 
ConnectionState
ÆÆ  /
.
ÆÆ/ 0
Open
ÆÆ0 4
)
ÆÆ4 5
{
ØØ 
cn
∞∞ 
.
∞∞ 
Close
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
}
±± 
return
≥≥ 
$num
≥≥ 
;
≥≥ 
}
¥¥ 
}
µµ 	
public
∑∑ 
async
∑∑ 
Task
∑∑ 
<
∑∑ 
	DataTable
∑∑ #
>
∑∑# $-
DB_Mostar_Todos_Usuarios_Evento
∑∑% D
(
∑∑D E
int
∑∑E H
Id_Even
∑∑I P
)
∑∑P Q
{
∏∏ 	
	DataTable
ππ 
data
ππ 
=
ππ 
new
ππ  
(
ππ  !
)
ππ! "
;
ππ" #
SqlConnection
∫∫ 
cn
∫∫ 
=
∫∫ 
new
∫∫ "
(
∫∫" #
)
∫∫# $
;
∫∫$ %
try
ºº 
{
ΩΩ 
cn
ææ 
.
ææ 
ConnectionString
ææ #
=
ææ$ %
con
ææ& )
;
ææ) *
SqlDataAdapter
øø 
da
øø !
=
øø" #
new
øø$ '
(
øø' (
$str
øø( :
,
øø: ;
cn
øø< >
)
øø> ?
;
øø? @
da
¿¿ 
.
¿¿ 
SelectCommand
¿¿  
.
¿¿  !
CommandType
¿¿! ,
=
¿¿- .
CommandType
¿¿/ :
.
¿¿: ;
StoredProcedure
¿¿; J
;
¿¿J K
da
¡¡ 
.
¡¡ 
SelectCommand
¡¡  
.
¡¡  !

Parameters
¡¡! +
.
¡¡+ ,
AddWithValue
¡¡, 8
(
¡¡8 9
$str
¡¡9 A
,
¡¡A B
Id_Even
¡¡C J
)
¡¡J K
;
¡¡K L
await
√√ 
cn
√√ 
.
√√ 
	OpenAsync
√√ "
(
√√" #
)
√√# $
;
√√$ %
da
≈≈ 
.
≈≈ 
Fill
≈≈ 
(
≈≈ 
data
≈≈ 
)
≈≈ 
;
≈≈ 
cn
∆∆ 
.
∆∆ 
Close
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
return
«« 
data
«« 
;
«« 
}
…… 
catch
   
(
   
	Exception
   
)
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
cn
ÃÃ 
.
ÃÃ 
State
ÃÃ 
==
ÃÃ 
ConnectionState
ÃÃ  /
.
ÃÃ/ 0
Open
ÃÃ0 4
)
ÃÃ4 5
{
ÕÕ 
cn
ŒŒ 
.
ŒŒ 
Close
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
œœ 
return
—— 
data
—— 
;
—— 
}
““ 
}
”” 	
public
’’ 
async
’’ 
Task
’’ 
<
’’ 
bool
’’ 
>
’’ )
BD_Eliminar_Evento_Relacion
’’  ;
(
’’; <
int
’’< ?
Id_Even
’’@ G
,
’’G H
int
’’I L
uid
’’M P
)
’’P Q
{
÷÷ 	
bool
◊◊ 
	respuesta
◊◊ 
=
◊◊ 
true
◊◊ !
;
◊◊! "
SqlConnection
ÿÿ 
cn
ÿÿ 
=
ÿÿ 
new
ÿÿ "
(
ÿÿ" #
)
ÿÿ# $
;
ÿÿ$ %
try
⁄⁄ 
{
€€ 
cn
‹‹ 
.
‹‹ 
ConnectionString
‹‹ #
=
‹‹$ %
con
‹‹& )
;
‹‹) *

SqlCommand
ﬁﬁ 
cmd
ﬁﬁ 
=
ﬁﬁ  
new
ﬁﬁ! $
(
ﬁﬁ$ %
$str
ﬁﬁ% C
,
ﬁﬁC D
cn
ﬁﬁE G
)
ﬁﬁG H
{
ﬂﬂ 
CommandTimeout
‡‡ "
=
‡‡# $
$num
‡‡% '
,
‡‡' (
CommandType
·· 
=
··  !
CommandType
··" -
.
··- .
StoredProcedure
··. =
}
‚‚ 
;
‚‚ 
cmd
‰‰ 
.
‰‰ 

Parameters
‰‰ 
.
‰‰ 
AddWithValue
‰‰ +
(
‰‰+ ,
$str
‰‰, 5
,
‰‰5 6
Id_Even
‰‰7 >
)
‰‰> ?
;
‰‰? @
cmd
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ 
.
ÂÂ 
AddWithValue
ÂÂ +
(
ÂÂ+ ,
$str
ÂÂ, 5
,
ÂÂ5 6
uid
ÂÂ7 :
)
ÂÂ: ;
;
ÂÂ; <
await
ÁÁ 
cn
ÁÁ 
.
ÁÁ 
	OpenAsync
ÁÁ "
(
ÁÁ" #
)
ÁÁ# $
;
ÁÁ$ %
int
ÈÈ 
getValue
ÈÈ 
=
ÈÈ 
Convert
ÈÈ &
.
ÈÈ& '
ToInt32
ÈÈ' .
(
ÈÈ. /
await
ÈÈ/ 4
cmd
ÈÈ5 8
.
ÈÈ8 9"
ExecuteNonQueryAsync
ÈÈ9 M
(
ÈÈM N
)
ÈÈN O
)
ÈÈO P
;
ÈÈP Q
if
ÎÎ 
(
ÎÎ 
getValue
ÎÎ 
>
ÎÎ 
$num
ÎÎ  
)
ÎÎ  !
{
ÏÏ 
	respuesta
ÌÌ 
=
ÌÌ 
false
ÌÌ  %
;
ÌÌ% &
}
ÓÓ 
else
ÔÔ 
{
 
	respuesta
ÒÒ 
=
ÒÒ 
true
ÒÒ  $
;
ÒÒ$ %
}
ÚÚ 
cmd
ÙÙ 
.
ÙÙ 

Parameters
ÙÙ 
.
ÙÙ 
Clear
ÙÙ $
(
ÙÙ$ %
)
ÙÙ% &
;
ÙÙ& '
cmd
ıı 
.
ıı 
Dispose
ıı 
(
ıı 
)
ıı 
;
ıı 
cn
ˆˆ 
.
ˆˆ 
Close
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
return
¯¯ 
	respuesta
¯¯  
;
¯¯  !
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
)
˙˙ 
{
˚˚ 
if
¸¸ 
(
¸¸ 
cn
¸¸ 
.
¸¸ 
State
¸¸ 
==
¸¸ 
ConnectionState
¸¸  /
.
¸¸/ 0
Open
¸¸0 4
)
¸¸4 5
{
˝˝ 
cn
˛˛ 
.
˛˛ 
Close
˛˛ 
(
˛˛ 
)
˛˛ 
;
˛˛ 
}
ˇˇ 
return
ÅÅ 
	respuesta
ÅÅ  
;
ÅÅ  !
}
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
}ÖÖ ©F
SE:\visual\ricardo\Backend-C#\CalendarBackend\Capa_Datos\services\SdbNotificacion.cs
	namespace 	

Capa_Datos
 
{ 
public 

class 
SdbNotificacion  
:! "
IDbNotificacion# 2
{ 
private

 
readonly

 
string

 
con

  #
=

$ %
$str

& t
;

t u
public 
async 
Task 
< 
bool 
> $
BD_Eliminar_Notificacion  8
(8 9
int9 <
Id_Not= C
,C D
intE H
Id_UsuI O
)O P
{ 	
SqlConnection 
cn 
= 
new "
(" #
)# $
;$ %
bool 
	respuesta 
= 
true !
;! "
try 
{ 
cn 
. 
ConnectionString #
=$ %
con& )
;) *

SqlCommand 
cmd 
=  
new! $
($ %
$str% ?
,? @
cnA C
)C D
{ 
CommandTimeout "
=# $
$num% '
,' (
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
Id_Not7 =
)= >
;> ?
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
Id_Usu6 <
)< =
;= >
await 
cn 
. 
	OpenAsync "
(" #
)# $
;$ %
int   
getValue   
=   
Convert   &
.  & '
ToInt32  ' .
(  . /
await  / 4
cmd  5 8
.  8 9 
ExecuteNonQueryAsync  9 M
(  M N
)  N O
)  O P
;  P Q
if"" 
("" 
getValue"" 
>"" 
$num""  
)""  !
{## 
	respuesta$$ 
=$$ 
false$$  %
;$$% &
}%% 
else&& 
{'' 
	respuesta(( 
=(( 
true((  $
;(($ %
})) 
cmd++ 
.++ 

Parameters++ 
.++ 
Clear++ $
(++$ %
)++% &
;++& '
cmd,, 
.,, 
Dispose,, 
(,, 
),, 
;,, 
cn-- 
.-- 
Close-- 
(-- 
)-- 
;-- 
return// 
	respuesta//  
;//  !
}00 
catch11 
(11 
	Exception11 
)11 
{22 
if33 
(33 
cn33 
.33 
State33 
==33 
ConnectionState33  /
.33/ 0
Open330 4
)334 5
{44 
cn55 
.55 
Close55 
(55 
)55 
;55 
}66 
return88 
	respuesta88  
;88  !
}99 
}:: 	
public<< 
async<< 
Task<< 
<<< 
int<< 
><< %
BD_Registrar_Notificacion<< 8
(<<8 9 
NotificacionRegister<<9 M
notificacion<<N Z
)<<Z [
{== 	
SqlConnection>> 
cn>> 
=>> 
new>> "
(>>" #
)>># $
;>>$ %
int@@ 
	respuesta@@ 
;@@ 
tryBB 
{CC 

SqlCommandDD 
cmdDD 
=DD  
newDD! $
(DD$ %
)DD% &
;DD& '
cnEE 
.EE 
ConnectionStringEE #
=EE$ %
conEE& )
;EE) *
cmdFF 
.FF 
CommandTextFF 
=FF  !
$strFF" 7
;FF7 8
cmdGG 
.GG 

ConnectionGG 
=GG  
cnGG! #
;GG# $
cmdHH 
.HH 
CommandTimeoutHH "
=HH# $
$numHH% '
;HH' (
cmdII 
.II 
CommandTypeII 
=II  !
CommandTypeII" -
.II- .
StoredProcedureII. =
;II= >
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 4
,KK4 5
notificacionKK6 B
.KKB C
Id_UsuKKC I
)KKI J
;KKJ K
cmdLL 
.LL 

ParametersLL 
.LL 
AddWithValueLL +
(LL+ ,
$strLL, 4
,LL4 5
notificacionLL6 B
.LLB C
Id_NotaLLC J
)LLJ K
;LLK L
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 4
,MM4 5
notificacionMM6 B
.MMB C
Id_CreeMMC J
)MMJ K
;MMK L
awaitOO 
cnOO 
.OO 
	OpenAsyncOO "
(OO" #
)OO# $
;OO$ %
intQQ 
getValueQQ 
=QQ 
ConvertQQ &
.QQ& '
ToInt32QQ' .
(QQ. /
awaitQQ/ 4
cmdQQ5 8
.QQ8 9
ExecuteScalarAsyncQQ9 K
(QQK L
)QQL M
)QQM N
;QQN O
ifSS 
(SS 
getValueSS 
>SS 
$numSS  
)SS  !
{TT 
	respuestaUU 
=UU 
getValueUU  (
;UU( )
}VV 
elseWW 
{XX 
	respuestaYY 
=YY 
$numYY  !
;YY! "
}ZZ 
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Clear\\ $
(\\$ %
)\\% &
;\\& '
cmd]] 
.]] 
Dispose]] 
(]] 
)]] 
;]] 
cn^^ 
.^^ 
Close^^ 
(^^ 
)^^ 
;^^ 
}__ 
catch`` 
(`` 
	Exception`` 
)`` 
{aa 
ifcc 
(cc 
cncc 
.cc 
Statecc 
==cc 
ConnectionStatecc  /
.cc/ 0
Opencc0 4
)cc4 5
{dd 
cnee 
.ee 
Closeee 
(ee 
)ee 
;ee 
}ff 
returnhh 
$numhh 
;hh 
}ii 
returnkk 
	respuestakk 
;kk 
}ll 	
publicnn 
asyncnn 
Tasknn 
<nn 
	DataTablenn #
>nn# $0
$DB_Mostar_Todas_Notificacion_Usuarionn% I
(nnI J
intnnJ M
Id_UsunnN T
)nnT U
{oo 	
SqlConnectionpp 
cnpp 
=pp 
newpp "
(pp" #
)pp# $
;pp$ %
	DataTableqq 
dataqq 
=qq 
newqq  
(qq  !
)qq! "
;qq" #
tryss 
{tt 
cnuu 
.uu 
ConnectionStringuu #
=uu$ %
conuu& )
;uu) *
SqlDataAdaptervv 
davv !
=vv" #
newvv$ '
(vv' (
$strvv( B
,vvB C
cnvvD F
)vvF G
;vvG H
daww 
.ww 
SelectCommandww  
.ww  !
CommandTypeww! ,
=ww- .
CommandTypeww/ :
.ww: ;
StoredProcedureww; J
;wwJ K
daxx 
.xx 
SelectCommandxx  
.xx  !

Parametersxx! +
.xx+ ,
AddWithValuexx, 8
(xx8 9
$strxx9 A
,xxA B
Id_UsuxxC I
)xxI J
;xxJ K
awaitzz 
cnzz 
.zz 
	OpenAsynczz "
(zz" #
)zz# $
;zz$ %
da|| 
.|| 
Fill|| 
(|| 
data|| 
)|| 
;|| 
cn}} 
.}} 
Close}} 
(}} 
)}} 
;}} 
return 
data 
; 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
)
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
cn
ÑÑ 
.
ÑÑ 
State
ÑÑ 
==
ÑÑ 
ConnectionState
ÑÑ  /
.
ÑÑ/ 0
Open
ÑÑ0 4
)
ÑÑ4 5
{
ÖÖ 
cn
ÜÜ 
.
ÜÜ 
Close
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
return
ââ 
data
ââ 
;
ââ 
}
ää 
}
ãã 	
}
åå 
}çç 